(function(){"use strict";var e={root:"/",debug:false,async:true,type:"urlencoded",status:"status",data:"info",code:{success:1,fail:0,auth:-1},codeMap:{1:"success",0:"fail","-1":"auth"},setCode:function(t,n){if(t){e.code[n]=t;e.codeMap[t]=n}else{delete e.code[n];delete e.codeMap[t]}},handle:{auth:function(){},success:function(){},fail:function(){}},onerror:function(e){console.log("request error:",this,e)}};function t(e){var t=[];for(var n in e)if(e.hasOwnProperty(n)){t.push(encodeURIComponent(n)+"="+encodeURIComponent(e[n]))}return t.join("&")}var n=function(t,n,o){this.METHOD=t||"GET";this.ASYNC=typeof n==="undefined"?e.async:n;this.TYPE=typeof o==="undefined"?e.type:o;this.HEADERS={};this.PROPS={}};n.prototype={set:function(e,t){e=e.toUpperCase();if(this.hasOwnProperty(e)){this[e]=t}return this},callback:function(e,t){if(typeof t!=="undefined"){console.assert(typeof t==="function",n+" should be a function,",t);this.PROPS[e]=t}else if(e){for(var n in e){this.PROPS[n]=e[n]}}return this},request:function(n,o){var s=new XMLHttpRequest;for(var i in this.PROPS){if(this.PROPS[i]){s[i]=this.PROPS[i]}}if(e.root&&e.root!==n[0]){n=e.root+n}if(this.METHOD==="GET"){n+=t(o)}else if(o){switch(this.TYPE.toLowerCase()){case"urlencoded":case"url":s.setRequestHeader("Content-Type","application/x-www-form-urlencoded;charset=utf-8");if(typeof o==="string"&&o[0]==="{"&&o.slice(-1)==="}"){o=JSON.parse(o)}if(typeof o==="object"){o=t(o)}break;case"json":s.setRequestHeader("Content-Type","application/json;charset=utf-8");if(typeof o==="object"){o=JSON.stringify(o)}break;case"form":if(typeof o==="object"){var r=new FormData;for(var a in o){r.append(a,d[a])}o=r}break;default:if(this.TYPE){s.setRequestHeader("Content-Type",this.TYPE)}}}for(i in this.HEADERS){if(this.HEADERS.hasOwnProperty(i)){s.setRequestHeader(i,this.HEADERS[i])}}if(e.debug){console.log(n)}s.open(this.METHOD,n,this.ASYNC);s.send(o);return this}};function o(){var t=this;this.onerror=e.onerror;this.onload=function(){if(e.debug){console.log(this.status,this.responseText)}if(this.readyState===XMLHttpRequest.DONE){if(this.status>=200&&this.status<300){t.handle(this.responseText,this)}else{t.onerror(this)}}};this.handle=function(t,n){try{var o=JSON.parse(t);var s=this.getHandle("complete");if(s){s(o,n)}else{var i=o[e.status];i=e.codeMap[i];var r=this.getHandle(i);if(e.debug){console.debug(i,r,o)}if(r){r(o[e.data])}}}catch(e){console.error(e)}};return this}o.prototype={setHandle:function(t,n){if(typeof n!=="undefined"){this.handle[t]=n}else if(typeof t==="function"){this.handle=t}else if(e.debug){console.log("it's not callable",t,n)}return this},getHandle:function(t){if(t){return this.handle[t]||e.handle[t]}else{return this.handle}},request:function(e,t,o,s){new n(t,s).callback("onload",this.onload).callback("onerror",this.onerror).request(e,o);return this},delete:function(e,t){return this.request(e,"DELETE",null,t)}};["get","put","post","patch"].forEach(function(e){o.prototype[e]=function(t,n,o){return this.request(t,e.toUpperCase(),n,o)}});["success","fail","auth","complete"].forEach(function(e){o.prototype[e]=function(t){return this.setHandle(e,t)}});function s(t,n,s){if(arguments.length===1&&(typeof t["options"]==="object"||typeof t["handle"]==="object"||typeof t["code"]==="object")){n=t["handle"];s=t["code"];t=t["options"]}var i;for(i in t){e[i]=t[i]}for(i in n){e.handle[i]=n[i]}for(i in s){e.setCode(i,s[i])}return new o}var i=s;for(var r in o.prototype){i[r]=function(e){return function(){var t=new o;return o.prototype[e].apply(t,arguments)}}(r)}i.setCode=function(t,n){e.setCode(t,n);return i};i.getHandle=function(t){if(t){return e.handle[t]}else{return e.handle}};if(typeof module!=="undefined"&&typeof exports==="object"){module.exports=i}else if(typeof define==="function"&&define.amd){define(function(){return i})}else{this.YYF=i}}).call(function(){return this||(typeof window!=="undefined"?window:global)}());